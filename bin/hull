#!/usr/bin/env ruby
require 'fileutils'

ENV['HULL_FILE'] ||= File.join(Dir.pwd, 'hull', 'hull.rb')

arg_command = ARGV.shift

if arg_command == 'init'
  unless File.exists?(ENV['HULL_FILE'])
    FileUtils.mkdir_p(File.join(Dir.pwd, 'hull'))
    local_copy = File.join(File.dirname(__FILE__), '..', 'hull', 'hull.rb')
    FileUtils.cp(local_copy, ENV['HULL_FILE'])
  end
else
  require_relative "../lib/hull"
  include Hull::DSL
  require ENV['HULL_FILE']

  arg_package = ARGV.shift
  arg_node    = ARGV.shift

  if arg_command == 'apply'
    execute(arg_node, arg_package, :apply)
  elsif arg_command == 'remove'
    execute(arg_node, arg_package, :remove)
  else
    demonstrate(arg_node, arg_package, :apply)
  end
end